<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upload to OSS</title>
  <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .loading { display: none; }
        .nav-fixed {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 50;
        }
        .content-container {
            margin-top: 80px; /* æ ¹æ“šå°èˆªæ¬„é«˜åº¦èª¿æ•´ï¼Œé¿å…å…§å®¹è¢«é®æ“‹ */
        }
    </style>
</head>
<body class="bg-gray-900 min-h-screen flex flex-col">
    <!-- å°èˆªæ¬„ï¼šå›ºå®šåœ¨é ‚éƒ¨ -->
    <nav class="bg-gray-800 py-4 nav-fixed">
        <div class="container mx-auto flex justify-center space-x-8">
        <a href="/minimax_Router/minimax_Get" class="text-yellow-400 hover:text-yellow-100">GET</a>
        <a href="/minimax_Router/minimax_Image" class="text-yellow-400 hover:text-yellow-100">IMAGE</a>
        <a href="/minimax_Router/minimax_Subject-Reference" class="text-yellow-400 hover:text-yellow-100">SUBJECT_REFERENCE</a>
        <a href="/minimax_Router/minimax_Text" class="text-yellow-400 hover:text-yellow-100">TEXT</a>
      <a href="/minimax_Router/minimax_UploadImage" class="text-yellow-400 hover:text-yellow-100">ä¸Šå‚³åœ–ç‰‡</a>
      <a href="/minimax_Router/minimax_UploadImage/list" class="text-yellow-400 hover:text-yellow-100">åœ–ç‰‡åˆ—è¡¨</a>
        </div>
    </nav>

<div class="content-container flex-grow flex items-center justify-center px-4">
  <div class="mt-8 p-4 max-w-4xl mx-auto bg-white rounded-lg shadow">
    <h1 class="text-2xl font-bold text-center mb-6">ä¸Šå‚³åœ–ç‰‡è‡³é˜¿é‡Œé›² OSS</h1>

    <div id="drop-area" class="border-2 border-dashed border-gray-300 rounded-lg p-12 text-center cursor-pointer hover:border-blue-400 hover:bg-blue-50 transition">
      <div class="text-5xl mb-4 text-gray-400">ğŸ“</div>
      <p class="text-xl font-medium text-gray-700">æ‹–æ›³åœ–ç‰‡è‡³æ­¤</p>
      <p class="text-gray-500">æˆ–é»æ“Šé¸æ“‡æª”æ¡ˆ</p>
      <input type="file" id="file-input" class="hidden" accept="image/*" multiple>
    </div>

    <div id="upload-status" class="mt-4 text-center"></div>

    <div class="mt-6 text-center">
      <a href="/minimax_UploadImage/list" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-6 rounded-lg">
        æŸ¥çœ‹å·²ä¸Šå‚³åœ–ç‰‡
      </a>
    </div>
  </div>
</div>
  <script>
    const dropArea = document.getElementById('drop-area');
    const fileInput = document.getElementById('file-input');
    const status = document.getElementById('upload-status');

    dropArea.addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', () => handleFiles(fileInput.files));

    ['dragover', 'dragenter'].forEach(e => dropArea.addEventListener(e, ev => {
      ev.preventDefault();
      dropArea.classList.add('border-blue-500', 'bg-blue-50');
    }));
    ['dragleave', 'drop'].forEach(e => dropArea.addEventListener(e, ev => {
      if (e === 'drop') ev.preventDefault();
      dropArea.classList.remove('border-blue-500', 'bg-blue-50');
    }));
    dropArea.addEventListener('drop', e => handleFiles(e.dataTransfer.files));

function handleFiles(files) {
  const formData = new FormData();
  let valid = true;
  for (let f of files) {
    if (!f.type.startsWith('image/')) {
      alert(`è·³ééåœ–ç‰‡: ${f.name}`);
      valid = false;
    } else {
      formData.append('images', f);
    }
  }
  if (!valid || formData.entries().next().done) return;

  status.innerHTML = '<p class="text-blue-600">ä¸Šå‚³ä¸­...</p>';
  
  // ä¿®æ­£ï¼šä½¿ç”¨æ­£ç¢ºçš„è·¯ç”±è·¯å¾‘
  fetch('/minimax_Router/minimax_UploadImage', { method: 'POST', body: formData })
    .then(r => r.json())
    .then(d => {
      status.innerHTML = d.success
        ? `<p class="text-green-600">${d.message}</p>`
        : `<p class="text-red-600">${d.message}</p>`;
      if (d.success) setTimeout(() => location.reload(), 1000);
    })
    .catch(error => {
      console.error('ä¸Šå‚³éŒ¯èª¤:', error);
      status.innerHTML = '<p class="text-red-600">ä¸Šå‚³éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤</p>';
    });
}
  </script>
</body>
</html>